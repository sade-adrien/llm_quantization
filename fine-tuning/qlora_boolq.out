/home/et/miniconda3/envs/quantization_notebook/lib/python3.12/site-packages/transformers/utils/hub.py:124: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.16s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.21s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.35s/it]
/home/et/miniconda3/envs/quantization_notebook/lib/python3.12/site-packages/accelerate/accelerator.py:432: FutureWarning: Passing the following arguments to `Accelerator` is deprecated and will be removed in version 1.0 of Accelerate: dict_keys(['dispatch_batches', 'split_batches', 'even_batches', 'use_seedable_sampler']). Please pass an `accelerate.DataLoaderConfiguration` instead: 
dataloader_config = DataLoaderConfiguration(dispatch_batches=None, split_batches=False, even_batches=True, use_seedable_sampler=True)
  warnings.warn(
wandb: Currently logged in as: sade-adrien (esperanto). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /mnt/datascience1/Adrien/quantization/fine-tuning/wandb/run-20240422_100302-bakia3xw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earnest-field-150
wandb: ⭐️ View project at https://wandb.ai/esperanto/huggingface
wandb: 🚀 View run at https://wandb.ai/esperanto/huggingface/runs/bakia3xw
trainable params: 32,505,856 || all params: 7,274,237,952 || trainable%: 0.44686269839526965
  0%|          | 0/265 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/home/et/miniconda3/envs/quantization_notebook/lib/python3.12/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  0%|          | 1/265 [00:09<40:27,  9.19s/it]                                                 0%|          | 1/265 [00:09<40:27,  9.19s/it]  1%|          | 2/265 [00:17<36:55,  8.42s/it]                                                 1%|          | 2/265 [00:17<36:55,  8.42s/it]  1%|          | 3/265 [00:25<35:47,  8.20s/it]                                                 1%|          | 3/265 [00:25<35:47,  8.20s/it]  2%|▏         | 4/265 [00:32<35:15,  8.11s/it]                                                 2%|▏         | 4/265 [00:32<35:15,  8.11s/it]  2%|▏         | 5/265 [00:40<34:54,  8.06s/it]                                                 2%|▏         | 5/265 [00:40<34:54,  8.06s/it]  2%|▏         | 6/265 [00:48<34:38,  8.02s/it]                                                 2%|▏         | 6/265 [00:48<34:38,  8.02s/it]  3%|▎         | 7/265 [00:56<34:25,  8.01s/it]                                                 3%|▎         | 7/265 [00:56<34:25,  8.01s/it]  3%|▎         | 8/265 [01:04<34:14,  8.00s/it]                                                 3%|▎         | 8/265 [01:04<34:14,  8.00s/it]  3%|▎         | 9/265 [01:12<34:06,  7.99s/it]                                                 3%|▎         | 9/265 [01:12<34:06,  7.99s/it]  4%|▍         | 10/265 [01:20<33:57,  7.99s/it]                                                  4%|▍         | 10/265 [01:20<33:57,  7.99s/it]  4%|▍         | 11/265 [01:28<33:50,  7.99s/it]                                                  4%|▍         | 11/265 [01:28<33:50,  7.99s/it]  5%|▍         | 12/265 [01:36<33:42,  7.99s/it]                                                  5%|▍         | 12/265 [01:36<33:42,  7.99s/it]  5%|▍         | 13/265 [01:44<33:35,  8.00s/it]                                                  5%|▍         | 13/265 [01:44<33:35,  8.00s/it]  5%|▌         | 14/265 [01:52<33:27,  8.00s/it]                                                  5%|▌         | 14/265 [01:52<33:27,  8.00s/it]  6%|▌         | 15/265 [02:00<33:21,  8.01s/it]                                                  6%|▌         | 15/265 [02:00<33:21,  8.01s/it]  6%|▌         | 16/265 [02:08<33:13,  8.01s/it]                                                  6%|▌         | 16/265 [02:08<33:13,  8.01s/it]  6%|▋         | 17/265 [02:16<33:05,  8.00s/it]                                                  6%|▋         | 17/265 [02:16<33:05,  8.00s/it]  7%|▋         | 18/265 [02:24<32:57,  8.01s/it]                                                  7%|▋         | 18/265 [02:24<32:57,  8.01s/it]  7%|▋         | 19/265 [02:32<32:49,  8.00s/it]                                                  7%|▋         | 19/265 [02:32<32:49,  8.00s/it]  8%|▊         | 20/265 [02:40<32:41,  8.01s/it]                                                  8%|▊         | 20/265 [02:40<32:41,  8.01s/it]  8%|▊         | 21/265 [02:48<32:33,  8.01s/it]                                                  8%|▊         | 21/265 [02:48<32:33,  8.01s/it]  8%|▊         | 22/265 [02:56<32:25,  8.00s/it]                                                  8%|▊         | 22/265 [02:56<32:25,  8.00s/it]  9%|▊         | 23/265 [03:04<32:17,  8.01s/it]                                                  9%|▊         | 23/265 [03:04<32:17,  8.01s/it]  9%|▉         | 24/265 [03:12<32:09,  8.01s/it]                                                  9%|▉         | 24/265 [03:12<32:09,  8.01s/it]  9%|▉         | 25/265 [03:20<32:00,  8.00s/it]                                                  9%|▉         | 25/265 [03:20<32:00,  8.00s/it] 10%|▉         | 26/265 [03:28<31:51,  8.00s/it]                                                 10%|▉         | 26/265 [03:28<31:51,  8.00s/it] 10%|█         | 27/265 [03:36<31:41,  7.99s/it]                                                 10%|█         | 27/265 [03:36<31:41,  7.99s/it] 11%|█         | 28/265 [03:44<31:33,  7.99s/it]                                                 11%|█         | 28/265 [03:44<31:33,  7.99s/it] 11%|█         | 29/265 [03:52<31:25,  7.99s/it]                                                 11%|█         | 29/265 [03:52<31:25,  7.99s/it] 11%|█▏        | 30/265 [04:00<31:16,  7.99s/it]                                                 11%|█▏        | 30/265 [04:00<31:16,  7.99s/it] 12%|█▏        | 31/265 [04:08<31:07,  7.98s/it]                                                 12%|█▏        | 31/265 [04:08<31:07,  7.98s/it] 12%|█▏        | 32/265 [04:16<30:59,  7.98s/it]                                                 12%|█▏        | 32/265 [04:16<30:59,  7.98s/it] 12%|█▏        | 33/265 [04:24<30:50,  7.98s/it]                                                 12%|█▏        | 33/265 [04:24<30:50,  7.98s/it] 13%|█▎        | 34/265 [04:32<30:43,  7.98s/it]                                                 13%|█▎        | 34/265 [04:32<30:43,  7.98s/it] 13%|█▎        | 35/265 [04:40<30:35,  7.98s/it]                                                 13%|█▎        | 35/265 [04:40<30:35,  7.98s/it] 14%|█▎        | 36/265 [04:48<30:27,  7.98s/it]                                                 14%|█▎        | 36/265 [04:48<30:27,  7.98s/it] 14%|█▍        | 37/265 [04:56<30:19,  7.98s/it]                                                 14%|█▍        | 37/265 [04:56<30:19,  7.98s/it] 14%|█▍        | 38/265 [05:04<30:10,  7.98s/it]                                                 14%|█▍        | 38/265 [05:04<30:10,  7.98s/it] 15%|█▍        | 39/265 [05:12<30:03,  7.98s/it]                                                 15%|█▍        | 39/265 [05:12<30:03,  7.98s/it] 15%|█▌        | 40/265 [05:20<29:54,  7.97s/it]                                                 15%|█▌        | 40/265 [05:20<29:54,  7.97s/it] 15%|█▌        | 41/265 [05:28<29:46,  7.98s/it]                                                 15%|█▌        | 41/265 [05:28<29:46,  7.98s/it] 16%|█▌        | 42/265 [05:36<29:38,  7.97s/it]                                                 16%|█▌        | 42/265 [05:36<29:38,  7.97s/it] 16%|█▌        | 43/265 [05:44<29:30,  7.97s/it]                                                 16%|█▌        | 43/265 [05:44<29:30,  7.97s/it] 17%|█▋        | 44/265 [05:52<29:22,  7.98s/it]                                                 17%|█▋        | 44/265 [05:52<29:22,  7.98s/it] 17%|█▋        | 45/265 [06:00<29:14,  7.98s/it]                                                 17%|█▋        | 45/265 [06:00<29:14,  7.98s/it] 17%|█▋        | 46/265 [06:08<29:07,  7.98s/it]                                                 17%|█▋        | 46/265 [06:08<29:07,  7.98s/it] 18%|█▊        | 47/265 [06:16<28:58,  7.97s/it]                                                 18%|█▊        | 47/265 [06:16<28:58,  7.97s/it] 18%|█▊        | 48/265 [06:24<28:50,  7.97s/it]                                                 18%|█▊        | 48/265 [06:24<28:50,  7.97s/it] 18%|█▊        | 49/265 [06:32<28:42,  7.97s/it]                                                 18%|█▊        | 49/265 [06:32<28:42,  7.97s/it] 19%|█▉        | 50/265 [06:40<28:35,  7.98s/it]                                                 19%|█▉        | 50/265 [06:40<28:35,  7.98s/it] 19%|█▉        | 51/265 [06:48<28:27,  7.98s/it]                                                 19%|█▉        | 51/265 [06:48<28:27,  7.98s/it] 20%|█▉        | 52/265 [06:56<28:19,  7.98s/it]                                                 20%|█▉        | 52/265 [06:56<28:19,  7.98s/it] 20%|██        | 53/265 [07:04<28:11,  7.98s/it]                                                 20%|██        | 53/265 [07:04<28:11,  7.98s/it]